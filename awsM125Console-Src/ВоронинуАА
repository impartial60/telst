Александр здравствуй!

Высылаю приблизителный вариант драйвера встроенный в твое консольное приложение.
Все мои коды добавлены в три твои исходника и мой каталог.
1 main.cpp
2 threadGuidanceOfficer.cpp
3 servoDriveExecuter.cpp
4 каталог srcKram

Почти все места помечены меткой Крамаренко.

Прошу посмотреть, исправить и дополнить следующим функционалом:
В исходнике привода используются одинаковые структуры на все составляющие комплекса (УНВ и пусковые).
Тип устройства определяется в хедере "dеvice125.h" переменная "type" (st 133).
Режим устройства в переменной "mode" (st 104).
Режим устройства может принимать два значения - рельный и учебный.
В учебном режиме устройство, по замыслу, должно отвечать на запросы, внутренним сервером с адресами
127.0.0.ххх.(101,102,103,104,105).
Начальный вариант этого сервера приведен в исходнике "device125.cpp" функция "udpserver"
(st 151)

    В исходнике threadGuidanceOfficer.cpp добавлен сокет для работы с приводами.
Сокет связан с портом 50000 и использует любой адрес.
Нужно чтобы поддерживался только один, определенный в конфигурации.
Я по этому адресу и порту определяю разрешение доступа к приводу.
Адрес должен быть один на все привода - адрес АПУ.
Этот сокет раздает пакеты устройствам. По крайней мере я на это расчитывал когда писал этот код.

    Посоветуй как правильно сделать, учитывая твой стиль программирования в консольном приложении
на "С",следующее:
-нужно принять из вышеуказанного сокета пакеты от устройств и раздать их в структуры описанные
в моем дополнении идентифицируя пакет по адресу и номеру порта.
У меня написана заготовка. Я прошу тебя дописать код выполняющий вышесказанное.
Ты можешь проверить результат по обмену с внутренними серверами.
Эти сервера я планирую использовать в дальнейшем в качестве моделей приводов устройств.

    Из устройств ты будешь получать состояние концевиков и некоторого дополнительного оборудования.
Командами ты будешь управлять оборудованием, таким, как например, сканнеры УВ10, УВ11.
Это битовые поля. Состояние/управление будет доступно через функции set../get... Часть их уже описана в
дополнении.
Покажи как они будут вызываться из интерфейса пользователя.
Как будет выглядеть управление пушками. Ведь в комплексе еще 4 пушки.
Я в дополнении ввел все устройства комплекса.
Пока все.


С уважением
Анатолий Крамаренко
